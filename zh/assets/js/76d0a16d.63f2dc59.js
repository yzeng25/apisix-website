"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[84686],{3905:(e,n,r)=>{r.d(n,{Zo:()=>s,kt:()=>d});var t=r(67294);function o(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function a(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function i(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?a(Object(r),!0).forEach((function(n){o(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function u(e,n){if(null==e)return{};var r,t,o=function(e,n){if(null==e)return{};var r,t,o={},a=Object.keys(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||(o[r]=e[r]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var l=t.createContext({}),p=function(e){var n=t.useContext(l),r=n;return e&&(r="function"==typeof e?e(n):i(i({},n),e)),r},s=function(e){var n=p(e.components);return t.createElement(l.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},m=t.forwardRef((function(e,n){var r=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,s=u(e,["components","mdxType","originalType","parentName"]),m=p(r),d=o,g=m["".concat(l,".").concat(d)]||m[d]||c[d]||a;return r?t.createElement(g,i(i({ref:n},s),{},{components:r})):t.createElement(g,i({ref:n},s))}));function d(e,n){var r=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=m;var u={};for(var l in n)hasOwnProperty.call(n,l)&&(u[l]=n[l]);u.originalType=e,u.mdxType="string"==typeof e?e:o,i[1]=u;for(var p=2;p<a;p++)i[p]=r[p];return t.createElement.apply(null,i)}return t.createElement.apply(null,r)}m.displayName="MDXCreateElement"},34416:(e,n,r)=>{r.r(n),r.d(n,{contentTitle:()=>i,default:()=>s,frontMatter:()=>a,metadata:()=>u,toc:()=>l});var t=r(87462),o=(r(67294),r(3905));const a={title:"Consumer Group",keywords:["API gateway","Apache APISIX","Consumer Group"],description:"Consumer Group in Apache APISIX."},i=void 0,u={unversionedId:"terminology/consumer-group",id:"version-3.0/terminology/consumer-group",isDocsHomePage:!1,title:"Consumer Group",description:"Consumer Group in Apache APISIX.",source:"@site/docs-apisix_versioned_docs/version-3.0/terminology/consumer-group.md",sourceDirName:"terminology",slug:"/terminology/consumer-group",permalink:"/zh/docs/apisix/3.0/terminology/consumer-group",editUrl:"/zh/edit#https://github.com/apache/apisix/edit/release/3.0/docs/zh/latest/terminology/consumer-group.md",tags:[],version:"3.0",frontMatter:{title:"Consumer Group",keywords:["API gateway","Apache APISIX","Consumer Group"],description:"Consumer Group in Apache APISIX."},sidebar:"version-3.0/docs",previous:{title:"Consumer",permalink:"/zh/docs/apisix/3.0/terminology/consumer"},next:{title:"Global rule",permalink:"/zh/docs/apisix/3.0/terminology/global-rule"}},l=[],p={toc:l};function s(e){let{components:n,...r}=e;return(0,o.kt)("wrapper",(0,t.Z)({},p,r,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Consumer Groups are used to extract commonly used ",(0,o.kt)("a",{parentName:"p",href:"./plugin.md"},"Plugin")," configurations and can be bound directly to a ",(0,o.kt)("a",{parentName:"p",href:"./consumer.md"},"Consumer"),"."),(0,o.kt)("p",null,"With consumer groups, you can define any number of plugins, e.g. rate limiting and apply them to a set of consumers,\ninstead of managing each consumer individually."),(0,o.kt)("p",null,"While configuring the same plugin for the same route, only one copy of the configuration is valid."),(0,o.kt)("p",null,"The example below illustrates how to create a Consumer Group and bind it to a Consumer:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/consumer_groups/company_a -H \'X-API-KEY: edd1c9f034335f136f87ad84b625c8f1\' -X PUT -d \'\n{\n    "plugins": {\n        "limit-count": {\n            "count": 200,\n            "time_window": 60,\n            "rejected_code": 503,\n            "group": "$consumer_group_id"\n        }\n    }\n}\'\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'curl http://127.0.0.1:9180/apisix/admin/consumers -H \'X-API-KEY: edd1c9f034335f136f87ad84b625c8f1\' -X PUT -d \'\n{\n    "username": "jack",\n    "plugins": {\n        "key-auth": {\n            "key": "auth-one"\n        }\n    },\n    "group_id": "company_a"\n}\'\n')),(0,o.kt)("p",null,"When APISIX can't find the Consumer Group with the ",(0,o.kt)("inlineCode",{parentName:"p"},"group_id"),", the Admin API is terminated with a status code of ",(0,o.kt)("inlineCode",{parentName:"p"},"400"),"."),(0,o.kt)("p",null,"If a Consumer already has the ",(0,o.kt)("inlineCode",{parentName:"p"},"plugins")," field configured, the plugins in the Consumer Group will effectively be merged into it. The same plugin in the Consumer Group will not override the one configured directly in the Consumer."),(0,o.kt)("p",null,"For example, if we configure a Consumer Group as shown below:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "id": "bar",\n    "plugins": {\n        "response-rewrite": {\n            "body": "hello"\n        }\n    }\n}\n')),(0,o.kt)("p",null,"To a Consumer as shown below."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "username": "foo",\n    "group_id": "bar",\n    "plugins": {\n        "basic-auth": {\n            "username": "foo",\n            "password": "bar"\n        },\n        "response-rewrite": {\n            "body": "world"\n        }\n    }\n}\n')),(0,o.kt)("p",null,"Then the ",(0,o.kt)("inlineCode",{parentName:"p"},"body")," in ",(0,o.kt)("inlineCode",{parentName:"p"},"response-rewrite")," keeps ",(0,o.kt)("inlineCode",{parentName:"p"},"world"),"."))}s.isMDXComponent=!0}}]);